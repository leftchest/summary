# ChatGPT Summary Plugin

一个基于 ChatGPT 的聊天记录总结插件，支持多模态图片识别功能。

## 功能特点

- 支持聊天记录总结
- 支持图片自动识别和描述
- 灵活的时间范围指定
- 自定义总结指令
- 多模态 LLM 支持

## 使用方法

### 基本命令

$总结 [参数]

### 支持的命令格式

- `$总结 100` - 总结最近100条消息
- `$总结 -2h 100` - 总结过去2小时内的消息，最多100条
- `$总结 -24h` - 总结过去24小时内的消息
- `$总结 100 自定义指令` - 总结最近100条消息，并按照自定义指令进行总结

### 自定义指令说明

自定义指令可以在命令末尾添加，用于指定总结的重点和方向：

- `$总结 100 只总结和股票相关的内容` - 从最近100条消息中提取股票相关内容
- `$总结 -2h 只关注技术讨论` - 总结过去2小时内的技术讨论
- `$总结 -24h 200 请用幽默的语气总结` - 用幽默的方式总结过去24小时内最多200条消息

优先级规则：
1. 自定义指令具有最高优先级
2. 如果涉及总结，会参考默认的总结规则
3. 没有自定义指令时，执行默认的总结操作

### 配置说明

在 `config.json` 中配置以下参数：

```json
{
    "open_ai_api_base": "https://api.openai.com/v1",
    "open_ai_api_key": "你的OpenAI API密钥",
    "open_ai_model": "gpt-4",
    "max_tokens": 2000,
    "max_input_tokens": 8000,
    "max_tokens_persession": 3600,
    
    "multimodal_llm_api_base": "多模态LLM API地址",
    "multimodal_llm_model": "多模态LLM模型名称",
    "multimodal_llm_api_key": "多模态LLM API密钥"
}
```

## 输出格式

总结内容将按以下格式输出：

```
1️⃣[Topic][热度🔥]
• 时间：月-日 时:分 - -日 时:分
• 参与者：
• 内容：
• 结论：
```

## 注意事项

1. 图片识别功能需要配置多模态 LLM 相关参数
2. 总结时间范围建议使用小时单位（如 -2h）
3. 自定义指令可以引导总结的方向和重点
4. 插件会自动过滤短命令消息（<50字符且包含$或#）

## 更新日志

### v1.2
- 支持小时单位的时间范围指定
- 优化图片处理机制
- 增强错误处理和日志记录
- 改进提示词配置加载逻辑

## 许可证

MIT License

本插件基于深蓝老大的代码修改而来，感谢深蓝大佬的贡献。